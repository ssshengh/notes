<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="794px" height="997px" viewBox="-0.5 -0.5 794 997"><defs><clipPath id="mx-clip-102-165-242-26-0"><rect x="102" y="165" width="242" height="26"/></clipPath><clipPath id="mx-clip-302-225-302-26-0"><rect x="302" y="225" width="302" height="26"/></clipPath></defs><g><rect x="17" y="310" width="680" height="650" rx="97.5" ry="97.5" fill="none" stroke="#0000cc" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/><rect x="18" y="140" width="680" height="140" rx="21" ry="21" fill="none" stroke="#0000cc" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/><rect x="43" y="80" width="110" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 98 120 L 98 980" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 100px; margin-left: 44px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">客户端</div></div></div></foreignObject></g><rect x="33" y="680" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 710px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">客户端解析 CA 证书、获取公钥，验证证书有效性</div></div></div></foreignObject></g><rect x="558" y="80" width="100" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 608 120 L 608 980" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 100px; margin-left: 559px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">服务端</div></div></div></foreignObject></g><path d="M 98 190 L 589.38 190" fill="none" stroke="#0066ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 606.38 190 L 589.38 198.5 L 589.38 181.5 Z" fill="none" stroke="#0066ff" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 190px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #0066FF; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Client Hello</div></div></div></foreignObject></g><path d="M 607.5 250 L 115.62 250" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 98.62 250 L 115.62 241.5 L 115.62 258.5 Z" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 250px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #FF9A03; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Server Hello</div></div></div></foreignObject></g><path d="M 607.5 440 L 115.62 440" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 98.62 440 L 115.62 431.5 L 115.62 448.5 Z" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 440px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #FF9A03; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Change Cipher Spec</div></div></div></foreignObject></g><path d="M 607.5 490 L 116.12 490" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 99.12 490 L 116.12 481.5 L 116.12 498.5 Z" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 490px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #FF9A03; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Encrypted Extensions</div></div></div></foreignObject></g><rect x="38" y="760" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#ff1c03" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 790px; margin-left: 39px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0808; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DH密钥交换<br />根据服务端返回的key_share计算主密钥</div></div></div></foreignObject></g><rect x="548" y="340" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#ff1c03" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 370px; margin-left: 549px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0808; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span style="">DH密钥交换<br />服务端根据key_share计算主密钥<br /></span></div></div></div></foreignObject></g><path d="M 97.5 845 L 594.63 845" fill="none" stroke="#0066ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 611.63 845 L 594.63 853.5 L 594.63 836.5 Z" fill="none" stroke="#0066ff" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 845px; margin-left: 356px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #0066FF; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Change Cipher Spec | Encrypted Handshake Message</div></div></div></foreignObject></g><path d="M 116.12 940 L 589.88 940" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 99.12 940 L 116.12 931.5 L 116.12 948.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 606.88 940 L 589.88 948.5 L 589.88 931.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="318" y="910" width="80" height="26" fill="none" stroke="none" pointer-events="all"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="18px"><text x="357.5" y="930.5">加密数据通信</text></g><rect x="698" y="200" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 210px; margin-left: 699px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">不加密</div></div></div></foreignObject></g><rect x="697" y="570" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 580px; margin-left: 698px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">对称加密</div></div></div></foreignObject></g><rect x="198" y="20" width="320" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 30px; margin-left: 199px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 24px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">TLS 1.3 握手流程示意图</div></div></div></foreignObject></g><rect x="98" y="160" width="250" height="26" fill="none" stroke="none" pointer-events="all"/><g fill="#0000CC" font-family="Helvetica" clip-path="url(#mx-clip-102-165-242-26-0)" font-size="12px"><text x="103.5" y="177.5">协议版本、客户端随机数和密码套件列表</text></g><rect x="298" y="220" width="310" height="26" fill="none" stroke="none" pointer-events="all"/><g fill="#FF9A03" font-family="Helvetica" clip-path="url(#mx-clip-302-225-302-26-0)" font-size="12px"><text x="303.5" y="237.5">支持的 SSL/TLS 版本、服务器随机数和选择的密码套件</text></g><path d="M 607.5 540 L 116.12 540" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 99.12 540 L 116.12 531.5 L 116.12 548.5 Z" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 540px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #FF9A03; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">CA 证书</div></div></div></foreignObject></g><path d="M 608 590 L 116.62 590" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 99.62 590 L 116.62 581.5 L 116.62 598.5 Z" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 590px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #FF9A03; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Certificate Verify</div></div></div></foreignObject></g><path d="M 607.5 640 L 116.12 640" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 99.12 640 L 116.12 631.5 L 116.12 648.5 Z" fill="none" stroke="#ff9a03" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 640px; margin-left: 353px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #FF9A03; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Finished( Encrypted Handshake Message)</div></div></div></foreignObject></g><path d="M 98.5 890 L 589.88 890" fill="none" stroke="#0066ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 606.88 890 L 589.88 898.5 L 589.88 881.5 Z" fill="none" stroke="#0066ff" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 890px; margin-left: 354px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #0066FF; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Finished( Encrypted Handshake Message)</div></div></div></foreignObject></g></g></svg>